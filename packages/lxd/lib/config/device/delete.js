// Generated by CoffeeScript 2.4.1
// # `nikita.lxd.config.delete`

// Delete a device from a container

// ## Options

// * `container` (string, required)
//   The name of the container.
// * `device` (string, required)
//   Name of the device in LXD configuration, for example "eth0".

// ## Callback parameters

// * `err`
//   Error object if any.
// * `status`
//   True if the device was removed False otherwise.

// ## Example

// ```js
// require('nikita')
// .lxd.config.device.delete({
//   container: 'container1',
//   device: 'root',
// }, function(err, {status}){
//   console.log( err ? err.message : 'Device removed: ' + status);
// })
// ```

// ## Source Code
var validate_container_name;

module.exports = {
  handler: function({options}, callback) {
    this.log({
      message: "Entering lxd config.device",
      level: "DEBUG",
      module: "@nikitajs/lxd/lib/config/device/delete"
    });
    if (!options.container) {
      // Validation
      throw Error("Invalid Option: container is required");
    }
    validate_container_name(options.container);
    if (!options.device) {
      throw Error("Invalid Option: Device name (options.device) is required");
    }
    return this.lxd.config.device.exists({
      container: options.container,
      device: options.device
    }, function(err, {status, config}) {
      if (err) {
        return callback(err);
      }
      if (!status) {
        return callback(null, {
          status: false
        });
      }
      this.system.execute({
        cmd: `lxc config device remove ${options.container} ${options.device}`
      }, function(err, {status}) {});
      if (err) {
        return callback(err);
      }
      return callback(null, {
        status: true
      });
    });
  }
};

// ## Dependencies
validate_container_name = require('../../misc/validate_container_name');
