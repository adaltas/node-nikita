{
    "componentChunkName": "component---src-templates-action-js",
    "path": "/current/actions/docker/tools/execute/",
    "result": {"data":{"page":{"slug":"/current/actions/docker/tools/execute/","edit_url":"https://github.com/adaltas/node-nikita/edit/master/packages/docker/src/tools/execute.coffee.md","package":{"id":"1059e47b-def4-5e23-bcd4-998ebaa82bfa","keywords":["nikita","build","cli","deploy","fs","install","masson","ssh","system","task"]},"name":"docker.tools.execute","version":{"alias":"current"},"parent":{"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Execute a docker command.\"), mdx(\"h2\", {\n    \"id\": \"schema-definitions\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#schema-definitions\",\n    \"aria-label\": \"schema definitions permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Schema definitions\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"definitions =\\n  config:\\n    type: 'object'\\n    allOf: [\\n      $ref: '#/definitions/docker'\\n    ,\\n      properties:\\n        'bash':\\n          type: ['boolean', 'string']\\n          description: '''\\n          Serialize the command into a file and execute it with bash.\\n          '''\\n        'command':\\n          oneOf: [\\n            type: 'string'\\n          ,\\n            typeof: 'function'\\n          ]\\n          description: '''\\n          String, Object or array; Command to execute. A value provided as a\\n          function is interpreted as an action and will be called by forwarding\\n          the config object. The result is the expected to be the command\\n          to execute.\\n          '''\\n        'cwd':\\n          type: 'string'\\n          description: '''\\n          Current working directory from where to execute the command.\\n          '''\\n        'code':\\n          type: 'array'\\n          default: [0]\\n          items:\\n            type: 'integer'\\n          description: '''\\n          Expected code(s) returned by the command, int or array of int, default\\n          to 0.\\n          '''\\n        'docker':\\n          $ref: '#/definitions/docker'\\n      ,\\n        $ref: 'module://@nikitajs/core/lib/actions/execute'\\n    ]\\n    required: ['command']\\n  # Note, we can't use additionalProperties properties with anyOf for now,\\n  # from the doc: \\\"There are some proposals to address this in the next\\n  # version of the JSON schema specification.\\\"\\n  # additionalProperties: false\\n  'docker':\\n    type: 'object'\\n    description: '''\\n    Isolate all the parent configuration properties into a docker\\n    property, used when providing and cascading a docker configuration at\\n    a global scale.\\n    '''\\n    properties:\\n      'boot2docker':\\n        type: 'boolean'\\n        default: false\\n        description: '''\\n        Whether to use boot2docker or not.\\n        '''\\n      'compose':\\n        type: 'boolean'\\n        description: '''\\n        Use the `docker compose` command instead of `docker`.\\n        '''\\n      'machine':\\n        type: 'string'\\n        format: 'hostname'\\n        description: '''\\n        Name of the docker-machine, required if using docker-machine.\\n        '''\\n# (\\n#   schema.properties[\\\"#{property}\\\"] =\\n#     $ref: \\\"module://@nikitajs/core/lib/actions/execute#/properties/#{property}\\\"\\n# ) for property in [\\n#   'code_skipped', 'dry', 'env', 'format', 'gid', 'stdin_log',\\n#   'stdout', 'stdout_return', 'stdout_log',\\n#   'stderr', 'stderr_return', 'stderr_log',\\n#   'sudo', 'target', 'trap', 'uid'\\n# ]\"))), mdx(\"h2\", {\n    \"id\": \"handler\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#handler\",\n    \"aria-label\": \"handler permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Handler\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"handler = ({config, tools: {find}}) ->\\n  # Global config\\n  config.docker = await find ({config: {docker}}) -> docker\\n  config[k] ?= v for k, v of config.docker\\n  opts = for option in utils[ unless config.compose then 'options' else 'compose_options' ]\\n    value = config[option]\\n    continue unless value?\\n    value = 'true' if value is true\\n    value = 'false' if value is false\\n    if option in ['tlsverify'] then  \\\"--#{option}\\\" else \\\"--#{option}=#{value}\\\"\\n  opts = opts.join ' '\\n  bin = if config.compose then 'bin_compose' else 'bin_docker'\\n  try\\n    await @execute config,\\n      command: \\\"\\\"\\\"\\n      export SHELL=/bin/bash\\n      export PATH=/opt/local/bin/:/opt/local/sbin/:/usr/local/bin/:/usr/local/sbin/:$PATH\\n      bin_boot2docker=$(command -v boot2docker)\\n      bin_docker=$(command -v docker)\\n      bin_machine=$(command -v docker-machine)\\n      bin_compose=$(command -v docker-compose)\\n      machine='#{config.machine or ''}'\\n      boot2docker='#{if config.boot2docker then '1' else ''}'\\n      docker=''\\n      if [[ $machine != '' ]] && [ $bin_machine ]; then\\n        if [ -z \\\"#{config.machine or ''}\\\" ]; then exit 5; fi\\n        if docker-machine status \\\"${machine}\\\" | egrep 'Stopped|Saved'; then\\n          docker-machine start \\\"${machine}\\\";\\n        fi\\n        eval \\\"$(${bin_machine} env ${machine})\\\"\\n      elif [[ $boot2docker != '1' ]] && [  $bin_boot2docker ]; then\\n        eval \\\"$(${bin_boot2docker} shellinit)\\\"\\n      fi\\n      $#{bin} #{opts} #{config.command}\\n      \\\"\\\"\\\"\\n  catch err\\n    throw Error err.stderr.trim() if utils.string.lines(err.stderr.trim()).length is 1\\n    throw Error err.stderr.trim().replace 'Error response from daemon: ', '' if /^Error response from daemon/.test err.stderr\"))), mdx(\"h2\", {\n    \"id\": \"exports\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#exports\",\n    \"aria-label\": \"exports permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Exports\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"module.exports =\\n  handler: handler\\n  # hooks:\\n  #   on_action: require('@nikitajs/core/lib/actions/execute').hooks.on_action\\n  metadata:\\n    argument_to_config: 'command'\\n    definitions: definitions\"))), mdx(\"h2\", {\n    \"id\": \"dependencies\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#dependencies\",\n    \"aria-label\": \"dependencies permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Dependencies\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"utils = require '../utils'\"))));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#nikitadockertoolsexecute","title":"nikita.docker.tools.execute","items":[{"url":"#schema-definitions","title":"Schema definitions"},{"url":"#handler","title":"Handler"},{"url":"#exports","title":"Exports"},{"url":"#dependencies","title":"Dependencies"}]}]},"excerpt":"nikita.docker.tools.execute Execute a docker command. Schema definitions Handler Exports Dependencies"}}},"pageContext":{}},
    "staticQueryHashes": ["2288906906","393869461"]}